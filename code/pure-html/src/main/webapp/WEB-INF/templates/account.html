<!--
=========================================================
* Soft UI Dashboard - v1.0.5
=========================================================

* Product Page: https://www.creative-tim.com/product/soft-ui-dashboard
* Copyright 2022 Creative Tim (https://www.creative-tim.com)
* Licensed under MIT (https://www.creative-tim.com/license)
* Coded by Creative Tim

=========================================================

* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
-->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8"/>
    <link rel="icon" type="image/png" href="assets/img/logo_white.png">
    <title>
        Bank WebApp by Riccardo Negri
    </title>

    <!-- Font -->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet"/>

    <!-- CSS Files -->
    <link id="pagestyle" th:href="@{/assets/css/style.css}" rel="stylesheet"/>
</head>

<body class="g-sidenav-show  bg-gray-100">
<div th:replace="/WEB-INF/templates/fragments/sidebar.html :: sidebar(activePage='Account', accountID=${account.id}, transactionID = null)"></div>
<main class="main-content position-relative max-height-vh-100 h-100 border-radius-lg ">
    <!-- Navbar -->
    <div th:replace="/WEB-INF/templates/fragments/navbar.html :: navbar(currentPage='Account', name = ${user.name}, surname = ${user.surname})"></div>
    <!-- End Navbar -->
    <div class="container-fluid pb-4">
        <!-- NEW -->
        <div class="row mt-1">
            <div class="col-md-7">
                <!-- Info about account -->
                <div class="row p-1">
                    <div class="col-xl-8 mb-xl-0 mb-4">
                        <div class="card bg-transparent shadow-xl">
                            <div class="overflow-hidden position-relative border-radius-xl"
                                 style="background-image: url('assets/img/background_account.jpg');">
                                <span class="mask bg-gradient-dark"></span>
                                <div class="card-body position-relative z-index-1 p-3">
                                    <p class="text-white text-sm opacity-8 mb-0">Bank Account Number</p>
                                    <h5 class="text-white mt-1 mb-6 pb-4"
                                        th:text="${account.code.substring(0,4)} + ' ' +  ${account.code.substring(4,8)} + ' ' + ${account.code.substring(8,12)}">
                                        4562&nbsp;&nbsp;&nbsp;1122&nbsp;&nbsp;&nbsp;2234</h5>
                                    <div class="d-flex pt-1">
                                        <div class="d-flex">
                                            <div class="me-4">
                                                <p class="text-white text-sm opacity-8 mb-0">Account Owner</p>
                                                <h6 class="text-white mb-0"
                                                    th:text="${user.name} + ' ' + ${user.surname}">Mario Rossi</h6>
                                            </div>
                                        </div>
                                        <div class="ms-auto w-20 d-flex align-items-end justify-content-end">
                                            <img class="w-40 mt-1" src="assets/img/logo_white.png" alt="logo">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="col">
                            <div class="card">
                                <div class="card-header mx-4 p-3 text-center">
                                    <div class="icon icon-shape icon-lg bg-gradient-primary shadow text-center border-radius-lg m-auto">
                                        <img class="w-65 mt-2 fas fa-landmark opacity-10" src="assets/img/balance.png"
                                             alt="logo">
                                    </div>
                                </div>
                                <div class="card-body pt-0 p-3 text-center">
                                    <h6 class="text-center mb-0">Balance</h6>
                                    <span class="text-xs"
                                          th:text="'Updated at ' + ${localDateTime}">Updated at 15:32 pm</span>
                                    <hr class="horizontal dark my-3">
                                    <h5 class="mb-0"
                                        th:text="'$ ' + ${#numbers.formatDecimal(account.balance, 0, 'COMMA', 2,'POINT')}">
                                        $2000</h5>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Transactions -->
                <div class="row p-3">
                    <div class="card h-100 mb-4">
                        <div class="card-header pb-0 px-3">
                            <div class="row">
                                <div class="col-md-6">
                                    <h6 class="mb-0">Your Transactions</h6>
                                </div>
                                <div class="col-md-6 d-flex justify-content-end align-items-center">
                                    <i class="far fa-calendar-alt me-2"></i>
                                    <small th:text="'Updated at ' + ${localDateTime}">Updated at 15:32 pm</small>
                                </div>
                            </div>
                        </div>
                        <div class="card-body pt-4 p-3">
                            <h6 th:if="${lastMonthTransactions.size > 0}"
                                class="text-uppercase text-body text-xs font-weight-bolder mb-3">Last month</h6>
                            <ul class="list-group" th:each="transaction: ${lastMonthTransactions}">
                                <li class="list-group-item border-0 d-flex justify-content-between ps-0 mb-2 border-radius-lg"
                                    th:if="${account.code == transaction.destination}">
                                    <div class="d-flex align-items-center">
                                        <button class="btn disabled btn-icon-only btn-rounded btn-outline-success mb-0 me-3 btn-sm d-flex align-items-center justify-content-center">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="" fill="none"
                                                 viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                                <path stroke-linecap="round" stroke-linejoin="round"
                                                      d="M7 11l5-5m0 0l5 5m-5-5v12"/>
                                            </svg>
                                        </button>
                                        <div class="d-flex flex-column">
                                            <h6 class="mb-1 text-dark text-sm"
                                                th:text="${transaction.sender.name} + ' ' + ${transaction.sender.surname}">
                                                Apple</h6>
                                            <span class="text-xs"
                                                  th:text="'Received from ' + ${transaction.origin.substring(0,4)} + ' ' +  ${transaction.origin.substring(4,8)} + ' ' + ${transaction.origin.substring(8,12)} + ' on ' + ${transaction.timestamp.toString().substring(0, transaction.timestamp.toString().length()-2)} "></span>
                                            <span class="text-xs" th:text="'Reason: ' + ${transaction.reason()}"></span>

                                        </div>
                                    </div>
                                    <div class="d-flex align-items-center text-success text-gradient text-sm font-weight-bold"
                                         th:text="'+ $ ' + ${#numbers.formatDecimal(transaction.amount, 0, 'COMMA', 2,'POINT')}">
                                    </div>
                                </li>
                                <li class="list-group-item border-0 d-flex justify-content-between ps-0 mb-2 border-radius-lg"
                                    th:if="${account.code == transaction.origin}">
                                    <div class="d-flex align-items-center">
                                        <button class="btn disabled btn-icon-only btn-rounded btn-outline-danger mb-0 me-3 btn-sm d-flex align-items-center justify-content-center">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="" fill="none"
                                                 viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                                <path stroke-linecap="round" stroke-linejoin="round"
                                                      d="M17 13l-5 5m0 0l-5-5m5 5V6"/>
                                            </svg>
                                        </button>
                                        <div class="d-flex flex-column">
                                            <h6 class="mb-1 text-dark text-sm"
                                                th:text="${transaction.receiver.name} + ' ' + ${transaction.receiver.surname}">
                                                Netflix</h6>
                                            <span class="text-xs"
                                                  th:text="'Sent to ' + ${transaction.destination.substring(0,4)} + ' ' +  ${transaction.destination.substring(4,8)} + ' ' + ${transaction.destination.substring(8,12)} + ' on ' + ${transaction.timestamp.toString().substring(0, transaction.timestamp.toString().length()-2)} "></span>
                                            <span class="text-xs" th:text="'Reason: ' + ${transaction.reason()}"></span>
                                        </div>
                                    </div>
                                    <div class="d-flex align-items-center text-danger text-gradient text-sm font-weight-bold"
                                         th:text="'- $ ' + ${#numbers.formatDecimal(transaction.amount, 0, 'COMMA', 2,'POINT')}">
                                    </div>
                                </li>
                            </ul>
                            <h6 th:if="${lastYearTransactions.size > 0}"
                                class="text-uppercase text-body text-xs font-weight-bolder my-3">Last year</h6>
                            <ul class="list-group" th:each="transaction: ${lastYearTransactions}">
                                <li class="list-group-item border-0 d-flex justify-content-between ps-0 mb-2 border-radius-lg"
                                    th:if="${account.code == transaction.destination}">
                                    <div class="d-flex align-items-center">
                                        <button class="btn disabled btn-icon-only btn-rounded btn-outline-success mb-0 me-3 btn-sm d-flex align-items-center justify-content-center">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="" fill="none"
                                                 viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                                <path stroke-linecap="round" stroke-linejoin="round"
                                                      d="M7 11l5-5m0 0l5 5m-5-5v12"/>
                                            </svg>
                                        </button>
                                        <div class="d-flex flex-column">
                                            <h6 class="mb-1 text-dark text-sm"
                                                th:text="${transaction.sender.name} + ' ' + ${transaction.sender.surname}">
                                                Apple</h6>
                                            <span class="text-xs"
                                                  th:text="'Received from ' + ${transaction.origin.substring(0,4)} + ' ' +  ${transaction.origin.substring(4,8)} + ' ' + ${transaction.origin.substring(8,12)} + ' on ' + ${transaction.timestamp.toString().substring(0, transaction.timestamp.toString().length()-2)} "></span>
                                            <span class="text-xs" th:text="'Reason: ' + ${transaction.reason()}"></span>
                                        </div>
                                    </div>
                                    <div class="d-flex align-items-center text-success text-gradient text-sm font-weight-bold"
                                         th:text="'+ $ ' + ${#numbers.formatDecimal(transaction.amount, 0, 'COMMA', 2,'POINT')}">
                                    </div>
                                </li>
                                <li class="list-group-item border-0 d-flex justify-content-between ps-0 mb-2 border-radius-lg"
                                    th:if="${account.code == transaction.origin}">
                                    <div class="d-flex align-items-center">
                                        <button class="btn disabled btn-icon-only btn-rounded btn-outline-danger mb-0 me-3 btn-sm d-flex align-items-center justify-content-center">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="" fill="none"
                                                 viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                                <path stroke-linecap="round" stroke-linejoin="round"
                                                      d="M17 13l-5 5m0 0l-5-5m5 5V6"/>
                                            </svg>
                                        </button>
                                        <div class="d-flex flex-column">
                                            <h6 class="mb-1 text-dark text-sm"
                                                th:text="${transaction.receiver.name} + ' ' + ${transaction.receiver.surname}">
                                                Netflix</h6>
                                            <span class="text-xs"
                                                  th:text="'Sent to ' + ${transaction.destination.substring(0,4)} + ' ' +  ${transaction.destination.substring(4,8)} + ' ' + ${transaction.destination.substring(8,12)} + ' on ' + ${transaction.timestamp.toString().substring(0, transaction.timestamp.toString().length()-2)} "></span>
                                            <span class="text-xs" th:text="'Reason: ' + ${transaction.reason()}"></span>
                                        </div>
                                    </div>
                                    <div class="d-flex align-items-center text-danger text-gradient text-sm font-weight-bold"
                                         th:text="'- $ ' + ${#numbers.formatDecimal(transaction.amount, 0, 'COMMA', 2,'POINT')}">
                                    </div>
                                </li>
                            </ul>
                            <h6 th:if="${previousTransactions.size > 0}"
                                class="text-uppercase text-body text-xs font-weight-bolder my-3">Previous</h6>
                            <ul class="list-group" th:each="transaction: ${previousTransactions}">
                                <li class="list-group-item border-0 d-flex justify-content-between ps-0 mb-2 border-radius-lg"
                                    th:if="${account.code == transaction.destination}">
                                    <div class="d-flex align-items-center">
                                        <button class="btn disabled btn-icon-only btn-rounded btn-outline-success mb-0 me-3 btn-sm d-flex align-items-center justify-content-center">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="" fill="none"
                                                 viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                                <path stroke-linecap="round" stroke-linejoin="round"
                                                      d="M7 11l5-5m0 0l5 5m-5-5v12"/>
                                            </svg>
                                        </button>
                                        <div class="d-flex flex-column">
                                            <h6 class="mb-1 text-dark text-sm"
                                                th:text="${transaction.sender.name} + ' ' + ${transaction.sender.surname}">
                                                Apple</h6>
                                            <span class="text-xs"
                                                  th:text="'Received from ' + ${transaction.origin.substring(0,4)} + ' ' +  ${transaction.origin.substring(4,8)} + ' ' + ${transaction.origin.substring(8,12)} + ' on ' + ${transaction.timestamp.toString().substring(0, transaction.timestamp.toString().length()-2)} "></span>
                                            <span class="text-xs" th:text="'Reason: ' + ${transaction.reason()}"></span>
                                        </div>
                                    </div>
                                    <div class="d-flex align-items-center text-success text-gradient text-sm font-weight-bold"
                                         th:text="'+ $ ' + ${#numbers.formatDecimal(transaction.amount, 0, 'COMMA', 2,'POINT')}">
                                    </div>
                                </li>
                                <li class="list-group-item border-0 d-flex justify-content-between ps-0 mb-2 border-radius-lg"
                                    th:if="${account.code == transaction.origin}">
                                    <div class="d-flex align-items-center">
                                        <button class="btn disabled btn-icon-only btn-rounded btn-outline-danger mb-0 me-3 btn-sm d-flex align-items-center justify-content-center">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="" fill="none"
                                                 viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                                <path stroke-linecap="round" stroke-linejoin="round"
                                                      d="M17 13l-5 5m0 0l-5-5m5 5V6"/>
                                            </svg>
                                        </button>
                                        <div class="d-flex flex-column">
                                            <h6 class="mb-1 text-dark text-sm"
                                                th:text="${transaction.receiver.name} + ' ' + ${transaction.receiver.surname}">
                                                Netflix</h6>
                                            <span class="text-xs"
                                                  th:text="'Sent to ' + ${transaction.destination.substring(0,4)} + ' ' +  ${transaction.destination.substring(4,8)} + ' ' + ${transaction.destination.substring(8,12)} + ' on ' + ${transaction.timestamp.toString().substring(0, transaction.timestamp.toString().length()-2)} "></span>
                                            <span class="text-xs" th:text="'Reason: ' + ${transaction.reason()}"></span>
                                        </div>
                                    </div>
                                    <div class="d-flex align-items-center text-danger text-gradient text-sm font-weight-bold"
                                         th:text="'- $ ' + ${#numbers.formatDecimal(transaction.amount, 0, 'COMMA', 2,'POINT')}">
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-5">
                <!-- Transaction form -->
                <div class="row p-1">
                    <div class="">
                        <div class="card h-100">
                            <div class="card-header pb-0 p-3">
                                <div class="row">
                                    <div class="col-6 d-flex align-items-center">
                                        <h6 class="mb-0">Make a Transaction</h6>
                                    </div>
                                </div>
                            </div>
                            <div class="card-body p-3 pb-0">
                                <div class="card-body">
                                    <form role="form" method="post" th:action="@{/make-transaction}">
                                        <input type="hidden" name="origin-code" th:value="${account.code}">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <label>Beneficiary name</label>
                                                <div class="mb-3">
                                                    <input type="text" class="form-control" placeholder="Username"
                                                           name="beneficiary-username" required>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <label>Beneficiary account</label>
                                                <div class="mb-3">
                                                    <input type="text" class="form-control"
                                                           placeholder="1111 2222 3333" name="destination-code"
                                                           required>
                                                </div>
                                            </div>
                                        </div>
                                        <label>Reason</label>
                                        <div class="mb-3">
                                            <input type="text" class="form-control" placeholder="Reason" name="reason"
                                                   required>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <label>Amount</label>
                                                <div class="mb-3">
                                                    <input type="number" class="form-control" placeholder="0" min="0"
                                                           name="amount" required>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="text-center pt-2">
                                                    <button type="submit" class="btn bg-gradient-info w-100 mt-4 mb-0">
                                                        Execute
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Contacts -->
                <div class="row p-3">
                    <div class="card">
                        <div class="card-header pb-0 px-3">
                            <h6 class="mb-0">Your Contacts</h6>
                        </div>
                        <div class="card-body pt-4 p-3">
                            <ul class="list-group">
                                <li th:each="contact: ${contacts}"
                                    class="list-group-item border-0 d-flex p-4 mb-2 bg-gray-100 border-radius-lg">
                                    <div class="d-flex flex-column">
                                        <h6 class="mb-3 text-sm"
                                            th:text="${contact.user.name} + ' ' + ${contact.user.surname}"></h6>
                                        <span class="mb-2 text-xs">Username: <span
                                                class="text-dark font-weight-bold ms-sm-2"
                                                th:text="${contact.user.username}">marcorossi</span></span>
                                        <span th:each="account : ${contact.accountList}" class="mb-2 text-xs">Account number: <span
                                                class="text-dark ms-sm-2 font-weight-bold"
                                                th:text="${account.substring(0,4)} + ' ' +  ${account.substring(4,8)} + ' ' + ${account.substring(8,12)}"></span></span>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>
</body>

</html>